<html>
<head>
    <meta content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="telephone=no" name="format-detection">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta charset="UTF-8">
    <title>演艺邦-微信公众号</title>
    <link rel="stylesheet" href="css/style.css">
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script type="text/javascript" src="js/config.js"></script>
</head>
<body>
<section class="header">
    <a href="#" class="logo"><img src="images/logo.jpg"/></a>
    <a href="#" class="app">点击下载演艺邦APP</a>
</section>
<div id="list"></div>
<div class="load_more" id="loadMore" style="display: none"  ng-bind="loadMoreText">点击加载更多...</div>
<p class="no_data_text" id="noDateText"></p>
<script>
function loadPageList(url, page){
    var page = page;
    var items = null;
    var pages = 1;
    var successCallback = function(data){
        var listHtml = '';

        items = data.l;
        page = data.p;
        pages = data.pl;

        if(items.length > 0){
            $('#noDateText').html( '');
            for(var i= 0, ii=items.length; i<ii; i++){
                var item = items[i];
                var lcImgHtml = item.b.ai ? '<img src="http://www.8-bd.com/i/attachments/1/'+item.b.ai+'"/>' : '';
                var lcImgClass = item.b.ai ? '' : 'noImgText';

                listHtml +=
                        '<section class="list"><div class="list_title"><img src="http://www.8-bd.com/i/avatars/thumbs1/'+item.uo.a+'"/><p>'+item.b.ti+'</p><p class="user_name">'+item.uo.n+'</p></div>'+
                        '<div class="list_tag"><span><img src="images/tag.jpg"/></span><span>'+item.b.ctag+'</span><span>&gt;</span><span>'+item.b.tag+'</span></div>'+
                        '<div class="list_content"><div class="lc_img">'+lcImgHtml+'</div><p class="'+lcImgClass+'">'+item.b.co+'</p></div>'+
                        '<div class="list_op"><span class="comment">评论</span><span class="comment_time">'+item.b.t+'</span></div></section>';
            }

            $('#list').append(listHtml);
            if(pages > 1 && page < pages){
                $('#loadMore').show();
                $('#loadMore').html('点击加载更多...').off().on('click', function(){
                    ++page;
                    if(page > pages){
                        $('#loadMore').html('没有了...');
                    }else{
                        $('#loadMore').html('正在加载...');
                        loadPageList('/list', page);
                    }
                });
            }else{
                $('#loadMore').hide().off();
            }

        }else{
            $('#noDateText').html( '暂时还没数据哦~');
        }
    };
    $.get(url, {page: page}, successCallback);
}

loadPageList('/list', 1);
</script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script type="text/javascript" src="js/wx.js"></script>
</body>
</html>